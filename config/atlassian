server {
    listen devops-support-incu.daimler.com.cn:80;
    server_name devops-support-incu.daimler.com.cn

    listen 443 default ssl;

    ssl                  	on;
    ssl_certificate      /var/nginx/ssl/nginx.crt;
    ssl_certificate_key /var/nginx/ssl/nginx.key;
    ssl_session_timeout  5m;
    ssl_protocols  SSLv2 SSLv3 TLSv1 TLSv1.1 TLSv1.2;
    ssl_ciphers  HIGH:!aNULL:!MD5;
    ssl_prefer_server_ciphers   on;

    location /confluence {
        client_max_body_size 300m;
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Server $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://172.21.4.133:8090/confluence;
    }
    location /synchrony {
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Server $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://172.21.4.133:8091/synchrony;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "Upgrade";
    }

    location /jira {
        client_max_body_size 100M;
        proxy_set_header X-Forwarded-Host $host;
        proxy_set_header X-Forwarded-Server $host;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_pass http://172.21.4.133:8080/jira;
    }

    location /bitbucket {
      client_max_body_size 0;
      proxy_pass 			http://172.21.4.133:7990;
      proxy_set_header 	X-Forwarded-Host $host;
      proxy_set_header 	X-Forwarded-Server $host;
      proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
      proxy_set_header    X-Real-IP $remote_addr;
      proxy_redirect 		off;
   }

   location /bamboo {
     proxy_pass 			 http://172.21.4.142:8085/bamboo;
     proxy_set_header 	X-Forwarded-Host $host;
     proxy_set_header 	X-Forwarded-Server $host;
     proxy_set_header    X-Forwarded-For $proxy_add_x_forwarded_for;
     proxy_set_header    X-Real-IP $remote_addr;
     proxy_redirect 		off;
  }

}
